{
  "hash": "185b558d72501d17b902a480a9495a0e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take Home Exercise 2\"\nsubtitle: \"Mini Challenge 1 - Question 2\"\nformat: docx\ndate: 05/13/2025\ndate-format: long\ndate-modified: last-modified\neditor: visual\nexecute:\n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n---\n\n\n\n[*Note: Please toggle between 'Show' and 'Hide' above based on your preference for viewing the R codes.*]{.underline}\n\n# 1 Setting the Scene\n\nOceanus native **Sailor Shift** is one of the most influential musical artists of her generation. Beginning her career on the quiet island of Oceanus, Sailor rose to prominence through the traditional genre of **Oceanus Folk**. Though she has since expanded into Indie Pop and Indie Folk, her roots remain a defining feature of her music, and the genre has grown alongside her global success.\n\nIn 2023, Sailor joined the all-female band **Ivy Echoes**, performing across Oceanus with bandmates Maya Jensen, Lila “Lilly” Hartman, Jade Thompson, and Sophie Ramirez. While the group disbanded in 2026 to pursue individual careers, Sailor’s breakthrough came in 2028 with a viral single that launched Oceanus Folk onto the global stage.\n\nSince then, Sailor has released chart-topping albums almost annually and is well known for her cross-genre collaborations. Her commitment to spreading Oceanus Folk and uplifting lesser-known artists has played a major role in elevating both the genre and her former bandmates, who continue to shape the music industry in various roles.\n\nNow, in 2040, as Sailor returns to Oceanus, journalist **Silas Reed** sets out to trace her journey and the evolving influence of Oceanus Folk. Using a structured dataset in the form of a knowledge graph, we explore how this genre spread, shifted, and left its mark on music worldwide.\n\n# 2 Our Task\n\nThis project supports Silas' research through visual analysis of a knowledge graph containing artists, songs, albums, genres, and industry relationships.\n\nThe objectives of this activity are to:\n\n-   Visualize the spread of Oceanus Folk's influence over time.\n\n-   Identify top genres and artists influenced by Oceanus Folk\n\n-   Examine how Oceanus Folk has evolved, particularly through Sailor Shift’s collaborations and genre crossovers\n\n# 3 Getting Started\n\n## 3.1 Loading packages\n\nThe following R packages were loaded using the `pacman::p_load()` function.\n\n-   **`tidyverse`** – Data manipulation and plotting\n\n-   **`jsonlite`** – Parsing JSON files\n\n-   **`SmartEDA`** – Exploratory data analysis\n\n-   **`ggrepel`** – Prevent overlapping text labels in plots\n\n-   **`ggthemes`** – Additional ggplot2 themes\n\n-   **`ggridges` / `ggdist`** – Density and distribution plots\n\n-   **`colorspace` / `scales`** – Color and scale customization\n\n-   **`dplyr`, `lubridate`** – Tidy data transformation and date handling\n\n-   **`patchwork`** – Combining multiple ggplots\n\n-   **`matrixStats`** – Efficient statistical functions for matrices\n\n-   **`treemapify`** – Treemap visualizations\n\n-   **`showtext`** – Custom font support in plots\n\n-   **`igraph`, `ggraph`, `tidygraph`** – Network and graph analysis\n\n-   **`naniar`** – Missing data visualization\n\n-   **`readr`** – Fast CSV and delimited file reading\n\n-   **`visNetwork`** – Interactive network graphs\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, jsonlite, ggrepel, ggdist, lubridate,\n               ggdist, scales, ggplot2, treemapify, igraph, ggraph, \n               tidygraph, readr, visNetwork, ggrepel, janitor, gganimate, dplyr)\n```\n:::\n\n\n\n## 3.2 Importing Data\n\nWe begin by importing the cleaned knowledge graph from the **`MC1_graph.json`** file, which contains nodes and edges representing artists, songs, genres, and relationships such as collaborations and influence.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the JSON file\nkg <- fromJSON(\"MC1/data/MC1_graph.json\")\n\n# Convert to data frames\nnodes_tbl <- bind_rows(kg$nodes)\nedges_tbl <- as_tibble(kg$links)\n\ncolnames(nodes_tbl)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"Node Type\"      \"name\"           \"single\"         \"release_date\"  \n [5] \"genre\"          \"notable\"        \"id\"             \"written_date\"  \n [9] \"stage_name\"     \"notoriety_date\"\n```\n\n\n:::\n\n```{.r .cell-code}\ncolnames(edges_tbl)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Edge Type\" \"source\"    \"target\"    \"key\"      \n```\n\n\n:::\n\n```{.r .cell-code}\nstr(nodes_tbl)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t17412 obs. of  10 variables:\n $ Node Type     : chr  \"Song\" \"Person\" \"Person\" \"Person\" ...\n $ name          : chr  \"Breaking These Chains\" \"Carlos Duffy\" \"Min Qin\" \"Xiuying Xie\" ...\n $ single        : logi  TRUE NA NA NA NA FALSE ...\n $ release_date  : chr  \"2017\" NA NA NA ...\n $ genre         : chr  \"Oceanus Folk\" NA NA NA ...\n $ notable       : logi  TRUE NA NA NA NA TRUE ...\n $ id            : int  0 1 2 3 4 5 6 7 8 9 ...\n $ written_date  : chr  NA NA NA NA ...\n $ stage_name    : chr  NA NA NA NA ...\n $ notoriety_date: chr  NA NA NA NA ...\n```\n\n\n:::\n:::\n\n\n\n# 4 Initial Exploratory Data Analysis\n\n## 4.1 Distribution of Edge Types\n\nThe dataset contains a variety of edge types, each representing a specific relationship such as *PerformerOf*, *CollaboratedWith*, *InspiredBy*, and *RecordedBy*. The distribution shows that performance and composition-based connections dominate the network, suggesting a strong emphasis on how artists contribute to songs and collaborate with each other. Edges like *InspiredBy* and *InterpolatesFrom* are crucial for tracking the influence of Oceanus Folk across genres and over time.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = edges_tbl, aes(y = `Edge Type`)) + \n  geom_bar(fill = \"#73112d\") +\n  labs(\n    title = \"Distribution of Edge Types\",\n    y = \"Edge Type\",\n    x = \"Count\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](TakeHomeEx02_files/figure-docx/unnamed-chunk-3-1.png)\n:::\n:::\n\n\n\n## 4.2 Distribution of Node Types\n\nNodes in the graph are categorized into types such as *Person*, *Song*, *Genre*, *RecordLabel*, and *Album*. The largest share belongs to *Person* and *Song*, which aligns with the network's purpose of mapping artistic contributions and collaborations. This diversity allows for nuanced exploration - from individual artists to genre evolution and production labels.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = nodes_tbl, aes(y = `Node Type`)) + \n  geom_bar(fill = \"#2d7311\") +\n  labs(\n    title = \"Distribution of Node Types\",\n    y = \"Node Type\",\n    x = \"Count\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](TakeHomeEx02_files/figure-docx/unnamed-chunk-4-1.png)\n:::\n:::\n\n\n\n## 4.3 Unique Entities by Node Type\n\nThis breakdown highlights the count of distinct entities within each node type. For example, we observe a high number of unique songs and artists, with relatively fewer genres and record labels. This reinforces the network’s depth in capturing individual creative works and their contributors, while also showing the limited but important role of overarching categories like genre.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnodes_tbl %>%\n  group_by(`Node Type`) %>%\n  summarise(`Number of Entities` = n()) %>%\n  arrange(desc(`Number of Entities`)) %>%\n  ggplot(aes(x = reorder(`Node Type`, `Number of Entities`), y = `Number of Entities`)) +\n  geom_col(fill = \"#112d73\") +\n  coord_flip() +\n  labs(\n    title = \"Number of Unique Entities by Node Type\",\n    x = \"Node Type\",\n    y = \"Count\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](TakeHomeEx02_files/figure-docx/unnamed-chunk-5-1.png)\n:::\n:::\n\n\n\n# 5 Data Cleaning & Preparation\n\nWe first extracted the **nodes** and **edges** from the `MC1_graph.json` file and converted them into tidy `tibble` format using `jsonlite` and `janitor`. Key fields such as `release_date`, `written_date`, and `notoriety_date` were converted to numeric year values for consistency in time-based analysis.\n\nNext, we handled missing or blank genre values by trimming whitespace and converting empty strings to `NA`. We also verified the uniqueness of each node by checking for duplicated IDs and removed any redundancies.\n\nThe cleaned datasets were then exported to CSV files (`nodes_cleaned.csv` and `edges_cleaned.csv`) to streamline future steps such as visualization and network modeling.\n\nThese preparation steps ensured the data was consistent, well-structured, and ready for detailed exploration of the Oceanus Folk music ecosystem.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Convert nodes and edges to tibbles\nnodes_tbl <- as_tibble(kg$nodes) %>% clean_names()\nedges_tbl <- as_tibble(kg$links) %>% clean_names()\n\n# Clean release_date and written_date to numeric years\nnodes_tbl <- nodes_tbl %>%\n  mutate(across(c(release_date, written_date, notoriety_date), ~as.numeric(.)))\n\n# Handle missing genres and unify naming if needed\nnodes_tbl <- nodes_tbl %>%\n  mutate(genre = str_trim(genre),\n         genre = ifelse(genre == \"\", NA, genre))\n\n# Deduplicate node IDs\nnodes_tbl <- nodes_tbl %>%\n  distinct(id, .keep_all = TRUE)\n\n# Export cleaned data to CSV for reuse\nwrite_csv(nodes_tbl, \"nodes_cleaned.csv\")\nwrite_csv(edges_tbl, \"edges_cleaned.csv\")\n```\n:::\n\n\n\n# 6 Visualizations\n\n## 6.1 Spread of Oceanus Folk's Influence Over Time\n\nTo assess how the influence of Oceanus Folk evolved, we visualized the number of songs influenced by the genre across different years. The results showed a gradual and consistent rise in influence peaking in the mid 2020s. This trend suggests that Oceanus Folk's impact was not sporadic, but steadily gained momentum over time, likely propelled by Sailor’s growing popularity and sustained collaborations with artists across multiple genres.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnodes <- read_csv(\"nodes_cleaned.csv\")\n\n# Filter Oceanus Folk songs with valid release dates\noceanus_songs <- nodes %>%\n  filter(node_type == \"Song\", genre == \"Oceanus Folk\", !is.na(release_date))\n\n# Create new column for release year\noceanus_songs <- oceanus_songs %>%\n  mutate(release_year = as.integer(release_date))\n\n# Count number of Oceanus Folk songs per year\nsongs_by_year <- oceanus_songs %>%\n  group_by(release_year) %>%\n  summarise(n = n(), .groups = \"drop\")\n\n# Plot\nggplot(songs_by_year, aes(x = release_year, y = n)) +\n  geom_col(fill = \"#112d73\", width = 0.6) +\n  geom_text(aes(label = n), vjust = -0.3, size = 3, color = \"black\") +\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.1))) +\n  labs(\n    title = \"Oceanus Folk Song Releases Over Time\",\n    subtitle = \"Count of Oceanus Folk song releases over the years\",\n    x = \"Release Year\",\n    y = \"Number of Songs\"\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 14),\n    plot.subtitle = element_text(size = 11),\n    axis.title.y = element_text(margin = margin(r = 10))\n  )\n```\n\n::: {.cell-output-display}\n![](TakeHomeEx02_files/figure-docx/unnamed-chunk-7-1.png)\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnodes_tbl <- read_csv(\"nodes_cleaned.csv\")\nedges_tbl <- read_csv(\"edges_cleaned.csv\")\nnodes_tbl <- as_tibble(nodes_tbl)\nedges_tbl <- as_tibble(edges_tbl)\n\n# Create ID to index mapping\nid_map <- tibble(id = nodes_tbl$id, index = seq_len(nrow(nodes_tbl)))\n\n# Join mapping to edges\nedges_tbl <- edges_tbl %>%\n  left_join(id_map, by = c(\"source\" = \"id\")) %>%\n  rename(from_index = index) %>%\n  left_join(id_map, by = c(\"target\" = \"id\")) %>%\n  rename(to_index = index) %>%\n  filter(!is.na(from_index), !is.na(to_index))\n\n# Creating graph\ngraph <- tbl_graph(\n  nodes = nodes_tbl,\n  edges = edges_tbl %>% select(from = from_index, to = to_index, everything()),\n  directed = TRUE\n)\n\n# Filter to Oceanus Folk\ngraph_oceanus <- graph %>%\n  activate(nodes) %>%\n  filter(str_detect(genre, \"Oceanus Folk\"))\n\n# Step 7: Visualization\nggraph(graph_oceanus, layout = \"fr\") +\n  geom_edge_link(alpha = 0.2, color = \"gray\") +\n  geom_node_point(aes(color = node_type), size = 3) +\n  geom_node_text(aes(label = name), repel = TRUE, size = 2.5) +\n  theme_void() +\n  labs(title = \"Influence of Oceanus Folk\")\n\n# Extract Oceanus Folk node IDs\noceanus_ids <- nodes_tbl %>%\n  filter(str_detect(genre, \"Oceanus Folk\")) %>%\n  pull(id)\n\nedges_oceanus <- edges_tbl %>%\n  filter(source %in% oceanus_ids | target %in% oceanus_ids)\n\n# VisNetwork\nnodes_vis <- nodes_tbl %>%\n  filter(id %in% c(edges_oceanus$source, edges_oceanus$target)) %>%\n  mutate(label = name,\n         title = paste0(\"<b>\", name, \"</b><br>Type: \", node_type, \"<br>Genre: \", genre),\n         color = case_when(\n           node_type == \"Person\" ~ \"#112d73\",\n           node_type == \"Song\" ~ \"#2d7311\",\n           node_type == \"Genre\" ~ \"#73112d\",\n           TRUE ~ \"#aaaaaa\"\n         )) %>%\n  select(id, label, title, color)\n\nedges_vis <- edges_oceanus %>%\n  select(from = source, to = target, label = edge_type)\n\nvisNetwork(nodes_vis, edges_vis, width = \"100%\", height = \"700px\") %>%\n  visEdges(arrows = \"to\") %>%\n  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE) %>%\n  visLayout(randomSeed = 42) %>%\n  visPhysics(stabilization = TRUE) %>%\n  visLegend(addNodes = list(\n    list(label = \"Person\", color = \"#112d73\"),\n    list(label = \"Song\", color = \"#2d7311\"),\n    list(label = \"Genre\", color = \"#73112d\")\n  ), useGroups = FALSE)\n```\n:::\n\n\n\n## 6.2 Genres and Top Artists Influenced by Oceanus Folk\n\nWe explored which genres and artists were most influenced by Oceanus Folk by analyzing `InspiredBy` and `InterpolatesFrom` edge relationships in the graph. A bar chart highlighted **Indie Folk**, **Indie Rock**, and **Alternative Rock** as top recipient genres of Oceanus Folk influence. In parallel, a dot plot showed the top individual artists repeatedly influenced, reinforcing the genre’s broad reach. These findings underscore how Oceanus Folk, once niche, became a key source of inspiration across several popular and evolving musical styles.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnodes_tbl <- read_csv(\"nodes_cleaned.csv\")\nedges_tbl <- read_csv(\"edges_cleaned.csv\")\nnodes_tbl <- as_tibble(nodes_tbl)\nedges_tbl <- as_tibble(edges_tbl)\n\n# Create ID-to-index map and re-index edges\nid_map <- tibble(id = nodes_tbl$id, index = seq_len(nrow(nodes_tbl)))\n\nleft_join <- dplyr::left_join\n\nedges_tbl <- edges_tbl %>%\n  left_join(id_map, by = c(\"source\" = \"id\")) %>%\n  rename(from_index = index) %>%\n  left_join(id_map, by = c(\"target\" = \"id\")) %>%\n  rename(to_index = index) %>%\n  filter(!is.na(from_index), !is.na(to_index))\n\n# Create tbl_graph object\ngraph <- tbl_graph(nodes = nodes_tbl,\n                   edges = edges_tbl %>% select(from = from_index, to = to_index, everything()),\n                   directed = TRUE)\n\n# Get Oceanus Folk nodes songs/artists\noceanus_nodes <- nodes_tbl %>%\n  filter(str_detect(genre, regex(\"Oceanus Folk\", ignore_case = TRUE)))\n\n# Influenced edges from Oceanus Folk\ninfluenced_edges <- edges_tbl %>%\n  filter(edge_type %in% c(\"influenced\", \"InterpolatedFrom\", \"InStyleOf\")) %>%\n  filter(source %in% oceanus_nodes$id)\n\ninfluenced_ids <- influenced_edges$target\n\ninfluenced_nodes <- nodes_tbl %>%\n  filter(id %in% influenced_ids)\n\n# Plot graph\ninfluenced_nodes %>%\n  filter(!is.na(genre)) %>%\n  group_by(genre) %>%\n  summarise(n = n()) %>%\n  arrange(desc(n)) %>%\n  slice_max(n, n = 10) %>%\n  ggplot(aes(x = reorder(genre, n), y = n)) +\n  geom_col(fill = \"#73112d\") +\n  coord_flip() +\n  labs(title = \"Top 10 Genres Influenced by Oceanus Folk\",\n       x = \"Genre\", y = \"Number of Influenced Nodes\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](TakeHomeEx02_files/figure-docx/unnamed-chunk-9-1.png)\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnodes_graph <- nodes %>%\n  mutate(index = row_number())  # NO -1\n\nleft_join <- dplyr::left_join\n\nedges_graph <- edges %>%\n  left_join(nodes_graph %>% select(id, source_index = index), by = c(\"source\" = \"id\")) %>%\n  left_join(nodes_graph %>% select(id, target_index = index), by = c(\"target\" = \"id\")) %>%\n  filter(!is.na(source_index), !is.na(target_index)) %>%\n  filter(source_index <= nrow(nodes_graph), target_index <= nrow(nodes_graph))\n\ngraph <- tbl_graph(\n  nodes = nodes_graph,\n  edges = edges_graph %>% select(source = source_index, target = target_index, edge_type),\n  directed = TRUE\n)\n\nggraph(graph, layout = \"fr\") +\n  geom_edge_link(aes(color = edge_type), alpha = 0.5) +\n  geom_node_point(aes(color = genre), size = 3) +\n  geom_node_text(aes(label = ifelse(name == \"Sailor Shift\", name, NA)), repel = TRUE, size = 4) +\n  labs(title = \"Oceanus Folk Influence Network\") +\n  theme_void()\n```\n:::\n\n\n\n## 6.3 The Evolution of Oceanus Folk\n\nTo understand how Oceanus Folk itself has changed over time, we traced the genres of songs and artists that influenced newer Oceanus Folk tracks. Our network and bar plots revealed that Sailor Shift’s collaborations often drew from **Indie Pop**, **Doom Metal** genres. These cross-genre influences indicate a transformation in Oceanus Folk’s sound — blending its traditional roots with more modern, eclectic styles. Sailor’s artistic direction appears to have expanded the genre’s boundaries while maintaining its core identity.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load data\nnodes <- read_csv(\"nodes_cleaned.csv\")\nedges <- read_csv(\"edges_cleaned.csv\")\n\n\n# Get Oceanus Folk song IDs\nof_ids <- nodes %>%\n  filter(node_type == \"Song\", genre == \"Oceanus Folk\") %>%\n  pull(id)\n\n# Filter and enrich influence edges with release year\nedges_influence <- edges %>%\n  filter(source %in% of_ids, edge_type %in% c(\"InspiredBy\", \"InterpolatesFrom\")) %>%\n  left_join(nodes %>% select(id, release_date), by = c(\"source\" = \"id\")) %>%\n  mutate(year = floor(as.numeric(release_date))) %>%\n  arrange(year)\n\n# Subset relevant nodes and assign index\nused_ids <- unique(c(edges_influence$source, edges_influence$target))\nnodes_sub <- nodes %>%\n  filter(id %in% used_ids) %>%\n  mutate(index = row_number()) %>%\n  select(index, id, name, node_type, genre, everything())\n\n# Reindex edges using node indices\nedges_sub <- edges_influence %>%\n  left_join(nodes_sub %>% select(id, source_index = index), by = c(\"source\" = \"id\")) %>%\n  left_join(nodes_sub %>% select(id, target_index = index), by = c(\"target\" = \"id\")) %>%\n  filter(!is.na(source_index), !is.na(target_index)) %>%\n  select(source = source_index, target = target_index, edge_type, year)\n\n# Build temporal graph and compute out-degree\ngraph_time <- tbl_graph(nodes = nodes_sub, edges = edges_sub, directed = TRUE) %>%\n  mutate(out_degree = centrality_degree(mode = \"out\"))\n\n# Create animated plot\np <- graph_time %>%\n  activate(edges) %>%\n  mutate(year = factor(year)) %>%\n  ggraph(layout = \"circle\") +\n  geom_edge_link(aes(color = year), alpha = 0.5, arrow = arrow(length = unit(2, 'mm'))) +\n  geom_node_point(aes(size = out_degree, color = node_type), alpha = 0.7) +\n  geom_node_text(\n  aes(label = ifelse(out_degree > quantile(out_degree, 0.90, na.rm = TRUE),\n                     name, NA)),size = 3,repel = TRUE) +\n  scale_color_manual(values = c(\"Person\" = \"#73112D\", \"Song\" = \"#112d73\", \"Genre\" = \"#2d7311\")) +\n  labs(title = \"Influence of Oceanus Folk Over Time: {closest_state}\") +\n  theme_void() +\n  enter_fade() +\n  exit_fade() +\n  transition_states(year, transition_length = 2, state_length = 1)\n\n# Render animation to GIF\n# gif_path <- \"oceanus_influence.gif\"\n# animate(p, renderer = gifski_renderer(gif_path), width = 800, height = 800, fps = 4)\n# cat(sprintf('![](%s)', gif_path))\n```\n:::\n\n\n\n![](images/clipboard-1250150143.gif)\n\nThis animated network graph illustrates how songs in the Oceanus Folk genre have influenced other artists and genres over time. Nodes represent individuals or genres, with node size corresponding to out-degree centrality - a proxy for influence. Each frame represents a year based on song release dates, revealing how Oceanus Folk’s reach expanded into global music networks.\n\n# 7 Conclusion\n\nThis analysis traced the rise and transformation of Oceanus Folk through the lens of Sailor Shift’s career and broader music industry trends. Visualizing the knowledge graph revealed that Oceanus Folk’s influence has grown steadily over the years, expanding into genres like Indie Folk and Alternative Rock. At the same time, the genre itself evolved — shaped by diverse collaborations and contemporary musical currents.\n",
    "supporting": [
      "TakeHomeEx02_files\\figure-docx"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}